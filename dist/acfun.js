!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("request")):"function"==typeof define&&define.amd?define(["request"],e):"object"==typeof exports?exports.qiguoPlayManage=e(require("request")):t.qiguoPlayManage=e(t.request)}(this,function(t){return webpackJsonpqiguoPlayManage([4],{0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){t.sort(function(t,e){return e.bittype-t.bittype});var e=t.length?t[0].bittype:void 0,n={};return t.forEach(function(t){n[t.bittype]||(n[t.bittype]=t.url)}),{highestDefintion:e,definitions:n}};e.buildPlayStreams=r},17:function(e,n){e.exports=t},22:function(t,e,n){"use strict";function r(t,e){for(var n,r=[],a=0,o="",i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)a=(a+r[i]+t.charCodeAt(i%t.length))%256,n=r[i],r[i]=r[a],r[a]=n;i=0,a=0;for(var u=0;u<e.length;u++)i=(i+1)%256,a=(a+r[i])%256,n=r[i],r[i]=r[a],r[a]=n,o+=String.fromCharCode(e.charCodeAt(u)^r[(r[i]+r[a])%256]);return o}function a(t){if(!t)return"";t=t.toString();var e,n,r,a,o,i,u,f=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);for(i=t.length,o=0,u="";o<i;){do{e=f[255&t.charCodeAt(o++)]}while(o<i&&-1==e);if(-1==e)break;do{n=f[255&t.charCodeAt(o++)]}while(o<i&&-1==n);if(-1==n)break;u+=String.fromCharCode(e<<2|(48&n)>>4);do{if(61==(r=255&t.charCodeAt(o++)))return u;r=f[r]}while(o<i&&-1==r);if(-1==r)break;u+=String.fromCharCode((15&n)<<4|(60&r)>>2);do{if(61==(a=255&t.charCodeAt(o++)))return u;a=f[a]}while(o<i&&-1==a);if(-1==a)break;u+=String.fromCharCode((3&r)<<6|a)}return u}function o(t){for(var e=0;;){if(e>=8)return 185025305^t;t=(t>>1)+((1&t)<<31),++e}}Object.defineProperty(e,"__esModule",{value:!0});var i={};!function(t){function e(t,e){var n=t[0],u=t[1],f=t[2],c=t[3];n=r(n,u,f,c,e[0],7,-680876936),c=r(c,n,u,f,e[1],12,-389564586),f=r(f,c,n,u,e[2],17,606105819),u=r(u,f,c,n,e[3],22,-1044525330),n=r(n,u,f,c,e[4],7,-176418897),c=r(c,n,u,f,e[5],12,1200080426),f=r(f,c,n,u,e[6],17,-1473231341),u=r(u,f,c,n,e[7],22,-45705983),n=r(n,u,f,c,e[8],7,1770035416),c=r(c,n,u,f,e[9],12,-1958414417),f=r(f,c,n,u,e[10],17,-42063),u=r(u,f,c,n,e[11],22,-1990404162),n=r(n,u,f,c,e[12],7,1804603682),c=r(c,n,u,f,e[13],12,-40341101),f=r(f,c,n,u,e[14],17,-1502002290),u=r(u,f,c,n,e[15],22,1236535329),n=a(n,u,f,c,e[1],5,-165796510),c=a(c,n,u,f,e[6],9,-1069501632),f=a(f,c,n,u,e[11],14,643717713),u=a(u,f,c,n,e[0],20,-373897302),n=a(n,u,f,c,e[5],5,-701558691),c=a(c,n,u,f,e[10],9,38016083),f=a(f,c,n,u,e[15],14,-660478335),u=a(u,f,c,n,e[4],20,-405537848),n=a(n,u,f,c,e[9],5,568446438),c=a(c,n,u,f,e[14],9,-1019803690),f=a(f,c,n,u,e[3],14,-187363961),u=a(u,f,c,n,e[8],20,1163531501),n=a(n,u,f,c,e[13],5,-1444681467),c=a(c,n,u,f,e[2],9,-51403784),f=a(f,c,n,u,e[7],14,1735328473),u=a(u,f,c,n,e[12],20,-1926607734),n=o(n,u,f,c,e[5],4,-378558),c=o(c,n,u,f,e[8],11,-2022574463),f=o(f,c,n,u,e[11],16,1839030562),u=o(u,f,c,n,e[14],23,-35309556),n=o(n,u,f,c,e[1],4,-1530992060),c=o(c,n,u,f,e[4],11,1272893353),f=o(f,c,n,u,e[7],16,-155497632),u=o(u,f,c,n,e[10],23,-1094730640),n=o(n,u,f,c,e[13],4,681279174),c=o(c,n,u,f,e[0],11,-358537222),f=o(f,c,n,u,e[3],16,-722521979),u=o(u,f,c,n,e[6],23,76029189),n=o(n,u,f,c,e[9],4,-640364487),c=o(c,n,u,f,e[12],11,-421815835),f=o(f,c,n,u,e[15],16,530742520),u=o(u,f,c,n,e[2],23,-995338651),n=i(n,u,f,c,e[0],6,-198630844),c=i(c,n,u,f,e[7],10,1126891415),f=i(f,c,n,u,e[14],15,-1416354905),u=i(u,f,c,n,e[5],21,-57434055),n=i(n,u,f,c,e[12],6,1700485571),c=i(c,n,u,f,e[3],10,-1894986606),f=i(f,c,n,u,e[10],15,-1051523),u=i(u,f,c,n,e[1],21,-2054922799),n=i(n,u,f,c,e[8],6,1873313359),c=i(c,n,u,f,e[15],10,-30611744),f=i(f,c,n,u,e[6],15,-1560198380),u=i(u,f,c,n,e[13],21,1309151649),n=i(n,u,f,c,e[4],6,-145523070),c=i(c,n,u,f,e[11],10,-1120210379),f=i(f,c,n,u,e[2],15,718787259),u=i(u,f,c,n,e[9],21,-343485551),t[0]=s(n,t[0]),t[1]=s(u,t[1]),t[2]=s(f,t[2]),t[3]=s(c,t[3])}function n(t,e,n,r,a,o){return e=s(s(e,t),s(r,o)),s(e<<a|e>>>32-a,n)}function r(t,e,r,a,o,i,u){return n(e&r|~e&a,t,e,o,i,u)}function a(t,e,r,a,o,i,u){return n(e&a|r&~a,t,e,o,i,u)}function o(t,e,r,a,o,i,u){return n(e^r^a,t,e,o,i,u)}function i(t,e,r,a,o,i,u){return n(r^(e|~a),t,e,o,i,u)}function u(t){/[\x80-\xFF]/.test(t)&&(t=unescape(encodeURI(t)));var n,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=t.length;n+=64)e(a,f(t.substring(n-64,n)));t=t.substring(n-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)o[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(e(a,o),n=0;n<16;n++)o[n]=0;return o[14]=8*r,e(a,o),a}function f(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function c(t){for(var e="",n=0;n<4;n++)e+=l[t>>8*n+4&15]+l[t>>8*n&15];return e}function d(t){for(var e=0;e<t.length;e++)t[e]=c(t[e]);return t.join("")}function s(t,e){return t+e&4294967295}var l="0123456789abcdef".split(""),h=function(t){return d(u(t))};if("5d41402abc4b2a76b9719d911017c592"!=h("hello"));t.md5=h}(i);var u=i.md5;e.md5=u,e.decodeAcfun=r,e.base64DecodeAcfun=a,e.getLetvKey=o},67:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefinitions=e.getResult=e.getPlayStreams=e.decryptAcFunPlayInfo=e.getEncryptPlayInfo=e.getSidAndSign=e.getYoukuInfo=e.getAcFunVideoId=e.getAcfunInfo=e.getPageParam=e.getAcfunType=e.getPart=e.getRemoteInfo=void 0;var a=function(){function t(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(a)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(1),i=r(o),u=n(2),f=r(u),c=n(3),d=n(22),s=n(0),l={deviceType:2},h="qiguoPlayManage-getDefintions-acfun: ",g={},v=function(t,e){var n=t.fetchParams,r=t.step,a=null;(0,c.fetch)(n,function(t){try{t=JSON.parse(t)}catch(t){a=JSON.stringify({fetchParams:n,step:r,value:{acFunInfo:"not json string"},expected:{acFunInfo:"json string"}})}e(a,t)})},y=function(t,e){var n=void 0;try{if("ac"===e)n=parseInt(t.match(/.+part=(\d+)/)[1],10)-1||0;else if("ab"===e)try{n=10*parseInt(t.match(/.+ab=?\d+_(\d+)/)[1],10)}catch(e){n=10*parseInt(t.match(/.+part=(\d+)/)[1],10)}}catch(t){n=0}return n},p=function(t){return t.match(/(ac|ab)=?(\d+)/)[1]},m=(0,f.default)(function(t,e,n,r){var a=t.url,o=t.cache,i=void 0===o?{}:o,u=void 0,f=void 0,c=void 0,d=null;try{var s=a.match(/(ac|ab)=?(\d+)/);f=n(a),u=s[2],c=e(a,f)}catch(t){d=h+"get page param error "+t.message}var l={urlId:u,type:f,part:c,url:a};i.pageParams=l,r(d,l)}),b=(0,f.default)(function(t,e,n){var r=e.urlId,a=e.type,o=(e.part,void 0);"ac"===a?o="http://api.aixifan.com/contents/"+r:"ab"===a&&(o="http://api.aixifan.com/bangumis/"+r+"?page="+encodeURIComponent(JSON.stringify({num:1,size:300}))),t({fetchParams:{url:o,headers:l},step:"getAcfunInfo"},n)}),I=(0,f.default)(function(t,e,n){var r=t.pageParams,a=r.type,o=r.part,i=(r.url,null),u=void 0;if(e.data&&e.data.videos&&e.data.videos.length){if("ac"===a)u=e.data.videos[o].videoId;else if("ab"===a){var f=e.data.videos.filter(function(t){return t.sort===o});u=f.length?f[0].videoId:e.data.videos[0].videoId}}else i=h+"acFunInfo 没有videos字段或者videos字段为空";console.log(u),n(i,u)}),P=(0,f.default)(function(t,e,n){t({fetchParams:{url:"http://www.acfun.cn/video/getVideo.aspx?id="+e},step:"getYoukuInfo"},n)}),A=(0,f.default)(function(t,e){var n=void 0,r=void 0,a=null,o=h+"youkuInfo 没有sid或者sign字段";try{n=t.sourceId,r=t.encode,n&&r||(a=o)}catch(t){a=o}e(a,{sid:n,sign:r})}),S=(0,f.default)(function(t,e,n){t({fetchParams:{url:"http://aplay-vod.cn-beijing.aliyuncs.com/acfun/web?vid="+e.sid+"&ct=85&ev=3&sign="+e.sign},step:"getEncryptPlayInfo"},n)}),C=(0,f.default)(function(t,e){var n=void 0,r=void 0,a=null;try{n=t.data,r=(0,d.decodeAcfun)("8bdc7e1a",(0,d.base64DecodeAcfun)(n))}catch(t){a=h+"acFunPlayInfo 解密失败"}e(a,{decryptPlayInfo:r})}),w=(0,f.default)(function(t,e){var n=t.decryptPlayInfo,r=void 0,a=null;try{r=JSON.parse(n).stream}catch(t){a=h+"playInfo没有streams字段"}e(a,{streams:r})}),_=function(t){var e=t.streams,n=[],r=null,o=new Map([["m3u8_hd3",5],["m3u8_hd",4],["m3u8_mp4",3],["m3u8_flv",3]]);try{e.forEach(function(t){var e=!0,r=!1,i=void 0;try{for(var u,f=o[Symbol.iterator]();!(e=(u=f.next()).done);e=!0){var c=a(u.value,2),d=c[0],s=c[1];if(t.stream_type===d)try{var l={};l.url=t.m3u8,l.bittype=s,n.push(l)}catch(t){console.log(h+"getFullVideo push error: "+t.message)}}}catch(t){r=!0,i=t}finally{try{!e&&f.return&&f.return()}finally{if(r)throw i}}})}catch(t){r=h+"单段视频获取失败 "+t.message}var i=(0,s.buildPlayStreams)(n),u=i.definitions,f=i.highestDefintion;return{err:r,definitions:u,highestDefintion:f}},x=function(t){var e=t.streams,n=null,r=[],o=0,i=new Map([["flvhd",2],["mp4hd",3],["mp4hd2",4],["mp4hd3",5]]);try{e.forEach(function(t){var e=!0,n=!1,u=void 0;try{for(var f,c=i[Symbol.iterator]();!(e=(f=c.next()).done);e=!0){var d=a(f.value,2),s=d[0],l=d[1];if(t.stream_type===s){o=t.duration;var h={},g=t.segs.map(function(t){return{url:t.url,duration:t.seconds}});h.bittype=l,h.url=g,r.push(h)}}}catch(t){n=!0,u=t}finally{try{!e&&c.return&&c.return()}finally{if(n)throw u}}})}catch(t){n=h+"多段视频获取失败 "+t.message}var u=(0,s.buildPlayStreams)(r),f=u.definitions,c=u.highestDefintion;return{err:n,definitions:f,highestDefintion:c,duration:o}},D=(0,f.default)(function(t,e){e(null,{singleVideoDefintions:_(t),multiVideoDefintions:x(t)})}),j=function(t,e){(0,i.default)([m({url:t,cache:g},y,p),b(v),I(g),P(v),A(),S(v),C(),w(),D()],function(t,n){e(t,n)})};e.getRemoteInfo=v,e.getPart=y,e.getAcfunType=p,e.getPageParam=m,e.getAcfunInfo=b,e.getAcFunVideoId=I,e.getYoukuInfo=P,e.getSidAndSign=A,e.getEncryptPlayInfo=S,e.decryptAcFunPlayInfo=C,e.getPlayStreams=w,e.getResult=D,e.getDefinitions=j}},[67])});